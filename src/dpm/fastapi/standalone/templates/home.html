{% extends "base.html" %}

{% block title %}CMDR - Home{% endblock %}

{% block content %}
<div class="max-w-4xl mx-auto">
    <h1 class="text-4xl font-bold mb-8">Welcome to DPM</h1>

    <!-- Status Card with auto-refresh -->
    <div class="card bg-base-200 shadow-xl mb-6">
        <div class="card-body">
            <h2 class="card-title">System Status</h2>
            <div
                id="status-display"
                hx-get="{{ url_for('ui:status-partial') }}"
                hx-trigger="load, every 1s"
                hx-swap="innerHTML"
            >
                <!-- Status info will be loaded here -->
                <div class="flex justify-center p-8">
                    <span class="loading loading-spinner loading-lg"></span>
                </div>
            </div>
        </div>
    </div>

    <!-- Recent Items -->
    {% if last_domain or last_project or last_phase or last_task %}
    <div class="card bg-base-200 shadow-xl mb-6">
        <div class="card-body">
            <h2 class="card-title">Recent</h2>
            <div class="flex flex-col gap-2">
                {% if last_domain %}
                <a href="{{ url_for('pm:domain', domain=last_domain) }}" class="btn btn-sm btn-outline justify-start">
                    <span class="badge badge-primary badge-xs mr-1">Domain</span>
                    {{ last_domain }}
                </a>
                {% endif %}
                {% if last_project %}
                <a href="{{ url_for('pm:project', domain=last_domain, project_id=last_project.project_id) }}" class="btn btn-sm btn-outline justify-start">
                    <span class="badge badge-secondary badge-xs mr-1">Project</span>
                    {{ last_project.name }}
                </a>
                {% endif %}
                {% if last_phase %}
                <a href="{{ url_for('pm:phase', domain=last_domain, phase_id=last_phase.phase_id) }}" class="btn btn-sm btn-outline justify-start">
                    <span class="badge badge-warning badge-xs mr-1">Phase</span>
                    {{ last_phase.name }}
                </a>
                {% endif %}
                {% if last_task %}
                <a href="{{ url_for('pm:task-detail', domain=last_domain, task_id=last_task.task_id) }}" class="btn btn-sm btn-outline justify-start">
                    <span class="badge badge-accent badge-xs mr-1">Task</span>
                    {{ last_task.name }}
                </a>
                {% endif %}
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Navigation Cards -->
    <div class="card bg-base-200 shadow-xl">
        <div class="card-body">
            <h2 class="card-title">Navigation</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <a href="{{ url_for('pm:domains')}}" class="btn btn-outline btn-primary">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path>
                    </svg>
                    Domains
                </a>
            </div>
        </div>
    </div>

</div>
{% endblock %}
