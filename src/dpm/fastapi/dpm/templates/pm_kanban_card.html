<div class="kanban-card bg-base-100 rounded-lg shadow p-3"
     data-task-id="{{ task.task_id }}"
     data-blockers="{{ task.blockers_json|default('[]')|e }}">
    <!-- Header with ID and actions -->
    <div class="flex items-center justify-between mb-2">
        <span class="text-xs text-base-content/50 font-mono">ID {{ task.task_id }}</span>
        <div class="flex items-center gap-1">
            <button hx-get="{{ url_for('pm:task-edit-modal', domain=domain, task_id=task.task_id) }}"
                    hx-target="#edit-modal-container"
                    hx-swap="innerHTML"
                    class="btn btn-ghost btn-xs"
                    title="Edit task">
                EDIT
            </button>
            <button hx-post="{{ url_for('pm:task-delete-board', domain=domain, task_id=task.task_id) }}"
                    hx-confirm="Are you sure you want to delete this task?"
                    hx-target="#board-message"
                    hx-swap="innerHTML"
                    class="btn btn-ghost btn-xs text-error"
                    title="Delete task">
                DELETE
            </button>
        </div>
    </div>

    <!-- Task title -->
    <h3 class="font-bold text-sm mb-2">{{ task.name }}</h3>

    <!-- Project info -->
    {% if task.project_name %}
    <div class="text-xs text-base-content/70 mb-1">
        <span class="text-base-content/50">Project:</span> {{ task.project_name }}
    </div>
    {% endif %}

    <!-- Phase info -->
    {% if task.phase_name %}
    <div class="text-xs text-base-content/70 mb-2">
        <span class="text-base-content/50">Phase:</span> {{ task.phase_name }}
    </div>
    {% endif %}

    <!-- Blocked indicator -->
    {% if task.status == 'Blocked' %}
    <div class="badge badge-error badge-sm mb-2">Blocked</div>
    {% endif %}

    <!-- Blockers list -->
    {% if task.blockers %}
    <div class="text-xs border-t border-base-300 pt-2 mt-2">
        <span class="text-base-content/50">Blocked by</span>
        <span class="text-warning">
            {% for blocker in task.blockers %}{{ blocker.name }}{% if not loop.last %}, {% endif %}{% endfor %}
        </span>
    </div>
    {% endif %}
</div>
